#!/bin/bash

set -e

app_dir=$(realpath "$(dirname "$0")/../")
db_dir=$(realpath "$(dirname "$0")")

# shellcheck disable=1090
source "${app_dir}/bin/utils" # ASCII, ascii_print

# shellcheck disable=1090
source "${db_dir}/utils" # build_db_uri, on_build_db_uri_error

ascii_print "\n$(date)\n" "cyan"
ascii_print "ðŸšª Connecting to Database\n" "yellow"

trap 'on_build_db_uri_error' ERR
psql_cmd="psql $(build_db_uri)"
trap - ERR

sh -c "${psql_cmd}"

printf "%b" "${ASCII["reset"]}"
